<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/png" href="/assets/mcubePlus.png" />
    <title>Verification Details | M'Cube Plus Admin</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      :root {
        --primary: #b47b18;
        --primary-dark: #6e4105;
        --primary-darker: #2b1903;
        --success: #10b981;
        --success-light: #d1fae5;
        --error: #ef4444;
        --error-light: #fee2e2;
        --warning: #f59e0b;
        --warning-light: #fef3c7;
        --gray-50: #f9fafb;
        --gray-100: #f3f4f6;
        --gray-200: #e5e7eb;
        --gray-300: #d1d5db;
        --gray-400: #9ca3af;
        --gray-500: #6b7280;
        --gray-600: #4b5563;
        --gray-700: #374151;
        --gray-800: #1f2937;
        --gray-900: #111827;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          "Helvetica Neue", Arial, sans-serif;
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        min-height: 100vh;
        color: var(--gray-900);
      }

      /* Header Styles */
      .header {
        background: linear-gradient(
          135deg,
          var(--primary-darker) 0%,
          var(--primary-dark) 40%,
          var(--primary) 100%
        );
        color: white;
        padding: 20px 32px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 20px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
        position: sticky;
        top: 0;
        z-index: 100;
      }

      .header-left {
        display: flex;
        align-items: center;
        gap: 16px;
      }

      .header-right {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .btn-back {
        padding: 10px 20px;
        background: rgba(255, 255, 255, 0.15);
        border: 1px solid rgba(255, 255, 255, 0.3);
        color: white;
        border-radius: 8px;
        text-decoration: none;
        font-size: 0.9375rem;
        font-weight: 500;
        transition: all 0.3s ease;
        display: inline-flex;
        align-items: center;
        gap: 8px;
      }

      .btn-back:hover {
        background: rgba(255, 255, 255, 0.25);
        transform: translateX(-4px);
      }

      .btn-download {
        padding: 10px 20px;
        background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        border: none;
        color: white;
        border-radius: 8px;
        text-decoration: none;
        font-size: 0.9375rem;
        font-weight: 500;
        transition: all 0.3s ease;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        cursor: pointer;
        box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
      }

      .btn-download:hover {
        background: linear-gradient(135deg, #059669 0%, #047857 100%);
        transform: translateY(-2px);
        box-shadow: 0 6px 16px rgba(16, 185, 129, 0.4);
      }

      .logo-mark {
        width: 48px;
        height: auto;
        display: block;
        animation: pulse 2s ease-in-out infinite;
      }

      @keyframes pulse {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.05);
        }
      }

      .header h1 {
        font-size: 1.5rem;
        font-weight: 700;
        letter-spacing: -0.025em;
      }

      /* Container */
      .container {
        max-width: 1400px;
        margin: 32px auto;
        padding: 0 32px;
      }

      /* Status Banner */
      .status-banner {
        padding: 24px 32px;
        border-radius: 16px;
        margin-bottom: 32px;
        display: flex;
        align-items: center;
        gap: 20px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        animation: slideDown 0.5s ease-out;
      }

      @keyframes slideDown {
        from {
          opacity: 0;
          transform: translateY(-20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .status-banner.approved {
        background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
        color: white;
      }

      .status-banner.failed {
        background: linear-gradient(135deg, var(--error) 0%, #dc2626 100%);
        color: white;
      }

      .status-icon {
        font-size: 3rem;
        line-height: 1;
      }

      .status-content h2 {
        font-size: 1.5rem;
        font-weight: 700;
        margin-bottom: 8px;
      }

      .status-content p {
        font-size: 1rem;
        opacity: 0.95;
      }

      /* Cards Grid */
      .cards-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 24px;
        margin-bottom: 32px;
      }

      .card {
        background: white;
        border-radius: 16px;
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
        padding: 28px;
        transition: all 0.3s ease;
        animation: fadeIn 0.6s ease-out;
        animation-fill-mode: both;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .card:nth-child(1) {
        animation-delay: 0.1s;
      }
      .card:nth-child(2) {
        animation-delay: 0.2s;
      }
      .card:nth-child(3) {
        animation-delay: 0.3s;
      }
      .card:nth-child(4) {
        animation-delay: 0.4s;
      }

      .card:hover {
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
        transform: translateY(-4px);
      }

      .card-title {
        font-size: 1.25rem;
        font-weight: 700;
        margin-bottom: 24px;
        color: var(--gray-900);
        display: flex;
        align-items: center;
        gap: 12px;
        border-bottom: 2px solid var(--gray-100);
        padding-bottom: 12px;
      }

      .card-icon {
        font-size: 1.5rem;
      }

      /* Image Card */
      .selfie-card {
        text-align: center;
      }

      .selfie-image {
        width: 100%;
        max-width: 400px;
        height: auto;
        border-radius: 12px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12);
        margin: 0 auto;
        display: block;
        transition: transform 0.3s ease;
      }

      .selfie-image:hover {
        transform: scale(1.02);
      }

      .no-image {
        padding: 60px 20px;
        background: var(--gray-50);
        border-radius: 12px;
        color: var(--gray-400);
        font-size: 1rem;
      }

      /* Detail Items */
      .detail-item {
        margin-bottom: 20px;
        padding: 16px;
        background: var(--gray-50);
        border-radius: 10px;
        border-left: 4px solid var(--primary);
        transition: all 0.2s ease;
      }

      .detail-item:hover {
        background: #fef3e6;
        border-left-color: var(--primary-dark);
      }

      .detail-label {
        font-size: 0.8125rem;
        color: var(--gray-500);
        margin-bottom: 6px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }

      .detail-value {
        font-size: 1.0625rem;
        color: var(--gray-900);
        font-weight: 600;
        word-break: break-word;
      }

      /* Status Badges */
      .badge {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 6px 14px;
        border-radius: 20px;
        font-size: 0.875rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }

      .badge-success {
        background: var(--success-light);
        color: var(--success);
      }

      .badge-error {
        background: var(--error-light);
        color: var(--error);
      }

      .badge-warning {
        background: var(--warning-light);
        color: var(--warning);
      }

      /* Person Data */
      .person-section {
        margin-bottom: 24px;
        padding: 20px;
        background: white;
        border-radius: 12px;
        border: 2px solid var(--gray-100);
      }

      .person-section-title {
        font-size: 1rem;
        font-weight: 700;
        color: var(--gray-700);
        margin-bottom: 16px;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .person-data-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 16px;
      }

      .person-data-item {
        padding: 12px;
        background: var(--gray-50);
        border-radius: 8px;
      }

      .person-data-label {
        font-size: 0.75rem;
        color: var(--gray-500);
        margin-bottom: 4px;
        font-weight: 600;
      }

      .person-data-value {
        font-size: 0.9375rem;
        color: var(--gray-900);
        font-weight: 500;
      }

      /* Address Cards */
      .address-card {
        margin-bottom: 16px;
        padding: 16px;
        background: linear-gradient(135deg, #fef3e6 0%, #ffffff 100%);
        border-radius: 10px;
        border: 1px solid var(--gray-200);
      }

      .address-type {
        font-size: 0.875rem;
        font-weight: 700;
        color: var(--primary-dark);
        margin-bottom: 12px;
        text-transform: uppercase;
      }

      /* API Response */
      .api-response-container {
        background: var(--gray-900);
        color: #e5e7eb;
        padding: 24px;
        border-radius: 12px;
        overflow-x: auto;
        position: relative;
      }

      .api-response-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 16px;
        padding-bottom: 12px;
        border-bottom: 1px solid var(--gray-700);
      }

      .api-response-title {
        font-size: 1rem;
        font-weight: 700;
        color: var(--primary);
      }

      .btn-copy {
        padding: 6px 16px;
        background: var(--primary);
        color: white;
        border: none;
        border-radius: 6px;
        font-size: 0.8125rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .btn-copy:hover {
        background: var(--primary-dark);
        transform: translateY(-2px);
      }

      pre {
        margin: 0;
        font-size: 0.8125rem;
        line-height: 1.8;
        font-family: "Courier New", Courier, monospace;
        overflow-x: auto;
      }

      .json-key {
        color: #93c5fd;
      }

      .json-string {
        color: #86efac;
      }

      .json-number {
        color: #fbbf24;
      }

      .json-boolean {
        color: #f472b6;
      }

      /* Error Message */
      .error-message {
        padding: 20px;
        background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
        border-left: 4px solid var(--error);
        border-radius: 10px;
        margin-bottom: 20px;
      }

      .error-message-title {
        font-size: 1rem;
        font-weight: 700;
        color: var(--error);
        margin-bottom: 8px;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .error-message-text {
        font-size: 0.9375rem;
        color: #7f1d1d;
        line-height: 1.6;
      }

      /* Responsive */
      @media (max-width: 768px) {
        .cards-grid {
          grid-template-columns: 1fr;
        }

        .container {
          padding: 0 16px;
        }

        .header {
          padding: 16px 20px;
        }

        .person-data-grid {
          grid-template-columns: 1fr;
        }
      }

      /* Loading Animation */
      @keyframes shimmer {
        0% {
          background-position: -1000px 0;
        }
        100% {
          background-position: 1000px 0;
        }
      }

      .skeleton {
        background: linear-gradient(
          90deg,
          #f0f0f0 25%,
          #e0e0e0 50%,
          #f0f0f0 75%
        );
        background-size: 1000px 100%;
        animation: shimmer 2s infinite;
      }
    </style>
  </head>
  <body>
    <div class="header">
      <div class="header-left">
        <a href="/admin/dashboard" class="btn-back">
          <span>‚Üê</span>
          <span>Back to Dashboard</span>
        </a>
        <img src="/assets/mcubePlus.png" alt="M'Cube Plus" class="logo-mark" />
        <h1>Verification Details</h1>
      </div>
      <div class="header-right">
        <a href="/admin/verification/<%= verification.session_id %>/download" class="btn-download">
          <span>üì•</span>
          <span>Download Report</span>
        </a>
      </div>
    </div>

    <div class="container">
      <!-- Status Banner -->
      <div class="status-banner <%= verification.status %>">
        <div class="status-icon">
          <% if (verification.status === 'approved') { %> ‚úÖ <% } else if
          (verification.status === 'failed') { %> ‚ùå <% } else { %> ‚è≥ <% } %>
        </div>
        <div class="status-content">
          <h2>
            <% if (verification.status === 'approved') { %> Verification
            Approved <% } else if (verification.status === 'failed') { %>
            Verification Failed <% } else { %> Verification Pending <% } %>
          </h2>
          <p>
            <% if (verification.status === 'approved') { %> Identity
            successfully verified on <%= new
            Date(verification.created_at).toLocaleString('en-US', { dateStyle:
            'full', timeStyle: 'short' }) %> <% } else if (verification.status
            === 'failed') { %> Verification attempt failed on <%= new
            Date(verification.created_at).toLocaleString('en-US', { dateStyle:
            'full', timeStyle: 'short' }) %> <% } else { %> Verification
            initiated on <%= new
            Date(verification.created_at).toLocaleString('en-US', { dateStyle:
            'full', timeStyle: 'short' }) %> <% } %>
          </p>
        </div>
      </div>

      <!-- Error Message (if failed) -->
      <% if (verification.status === 'failed' && responseData &&
      (responseData.message || responseData.msg)) { %>
      <div class="error-message">
        <div class="error-message-title">
          <span>‚ö†Ô∏è</span>
          <span>Error Details</span>
        </div>
        <div class="error-message-text">
          <%= responseData.message || responseData.msg || 'Verification failed'
          %>
        </div>
      </div>
      <% } %>

      <!-- Cards Grid -->
      <div class="cards-grid">
        <!-- Selfie Image -->
        <div class="card selfie-card">
          <div class="card-title">
            <span class="card-icon">üì∏</span>
            <span>Selfie Image</span>
          </div>
          <% if (verification.cloudinary_url) { %>
          <img
            src="<%= verification.cloudinary_url %>"
            alt="Selfie"
            class="selfie-image"
          />
          <% } else { %>
          <div class="no-image">
            <div style="font-size: 3rem; margin-bottom: 12px">üö´</div>
            <div>No selfie image available</div>
          </div>
          <% } %>
        </div>

        <!-- User Information -->
        <div class="card">
          <div class="card-title">
            <span class="card-icon">üë§</span>
            <span>User Information</span>
          </div>
          <div class="detail-item">
            <div class="detail-label">Full Name</div>
            <div class="detail-value"><%= verification.name %></div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Email Address</div>
            <div class="detail-value"><%= verification.email %></div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Ghana Card PIN</div>
            <div class="detail-value"><%= verification.pin_number %></div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Status</div>
            <div class="detail-value">
              <span
                class="badge badge-<%= verification.status === 'approved' ? 'success' : verification.status === 'failed' ? 'error' : 'warning' %>"
              >
                <%= verification.status.toUpperCase() %>
              </span>
            </div>
          </div>
        </div>

        <!-- Verification Details -->
        <div class="card">
          <div class="card-title">
            <span class="card-icon">üîç</span>
            <span>Verification Details</span>
          </div>
          <div class="detail-item">
            <div class="detail-label">Session ID</div>
            <div
              class="detail-value"
              style="font-size: 0.875rem; font-family: monospace"
            >
              <%= verification.session_id %>
            </div>
          </div>
          <% if (verification.transaction_guid) { %>
          <div class="detail-item">
            <div class="detail-label">Transaction GUID</div>
            <div
              class="detail-value"
              style="font-size: 0.875rem; font-family: monospace"
            >
              <%= verification.transaction_guid %>
            </div>
          </div>
          <% } %>
          <div class="detail-item">
            <div class="detail-label">Response Code</div>
            <div class="detail-value"><%= verification.code || 'N/A' %></div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Verified Status</div>
            <div class="detail-value">
              <span
                class="badge badge-<%= verification.verified === 'TRUE' || verification.verified === 'YES' ? 'success' : 'error' %>"
              >
                <%= verification.verified || 'N/A' %>
              </span>
            </div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Created At</div>
            <div class="detail-value">
              <%= new Date(verification.created_at).toLocaleString('en-US', {
              weekday: 'long', year: 'numeric', month: 'long', day: 'numeric',
              hour: '2-digit', minute: '2-digit' }) %>
            </div>
          </div>
        </div>
      </div>

      <!-- Person Data (if approved) -->
      <% if (personData && personData.person) { const person =
      personData.person; %>
      <div class="card" style="grid-column: 1 / -1">
        <div class="card-title">
          <span class="card-icon">üÜî</span>
          <span>Ghana Card Information</span>
        </div>

        <!-- Basic Info -->
        <div class="person-section">
          <div class="person-section-title">üìã Personal Details</div>
          <div class="person-data-grid">
            <% if (person.nationalId) { %>
            <div class="person-data-item">
              <div class="person-data-label">National ID</div>
              <div class="person-data-value"><%= person.nationalId %></div>
            </div>
            <% } %> <% if (person.cardId) { %>
            <div class="person-data-item">
              <div class="person-data-label">Card ID</div>
              <div class="person-data-value"><%= person.cardId %></div>
            </div>
            <% } %> <% if (person.surname) { %>
            <div class="person-data-item">
              <div class="person-data-label">Surname</div>
              <div class="person-data-value"><%= person.surname %></div>
            </div>
            <% } %> <% if (person.forenames) { %>
            <div class="person-data-item">
              <div class="person-data-label">Forenames</div>
              <div class="person-data-value"><%= person.forenames %></div>
            </div>
            <% } %> <% if (person.nationality) { %>
            <div class="person-data-item">
              <div class="person-data-label">Nationality</div>
              <div class="person-data-value"><%= person.nationality %></div>
            </div>
            <% } %> <% if (person.birthDate) { %>
            <div class="person-data-item">
              <div class="person-data-label">Date of Birth</div>
              <div class="person-data-value"><%= person.birthDate %></div>
            </div>
            <% } %> <% if (person.gender) { %>
            <div class="person-data-item">
              <div class="person-data-label">Gender</div>
              <div class="person-data-value"><%= person.gender %></div>
            </div>
            <% } %> <% if (person.cardValidFrom) { %>
            <div class="person-data-item">
              <div class="person-data-label">Card Valid From</div>
              <div class="person-data-value"><%= person.cardValidFrom %></div>
            </div>
            <% } %> <% if (person.cardValidTo) { %>
            <div class="person-data-item">
              <div class="person-data-label">Card Valid To</div>
              <div class="person-data-value"><%= person.cardValidTo %></div>
            </div>
            <% } %>
          </div>
        </div>

        <!-- Addresses -->
        <% if (person.addresses && person.addresses.length > 0) { %>
        <div class="person-section">
          <div class="person-section-title">üè† Addresses</div>
          <% person.addresses.forEach((address, index) => { %>
          <div class="address-card">
            <div class="address-type">
              <%= address.type || 'Address ' + (index + 1) %>
            </div>
            <div class="person-data-grid">
              <% if (address.town) { %>
              <div class="person-data-item">
                <div class="person-data-label">Town</div>
                <div class="person-data-value"><%= address.town %></div>
              </div>
              <% } %> <% if (address.community) { %>
              <div class="person-data-item">
                <div class="person-data-label">Community</div>
                <div class="person-data-value"><%= address.community %></div>
              </div>
              <% } %> <% if (address.districtName) { %>
              <div class="person-data-item">
                <div class="person-data-label">District</div>
                <div class="person-data-value"><%= address.districtName %></div>
              </div>
              <% } %> <% if (address.region) { %>
              <div class="person-data-item">
                <div class="person-data-label">Region</div>
                <div class="person-data-value"><%= address.region %></div>
              </div>
              <% } %> <% if (address.countryName) { %>
              <div class="person-data-item">
                <div class="person-data-label">Country</div>
                <div class="person-data-value"><%= address.countryName %></div>
              </div>
              <% } %> <% if (address.postalCode) { %>
              <div class="person-data-item">
                <div class="person-data-label">Postal Code</div>
                <div class="person-data-value"><%= address.postalCode %></div>
              </div>
              <% } %> <% if (address.street) { %>
              <div class="person-data-item">
                <div class="person-data-label">Street</div>
                <div class="person-data-value"><%= address.street %></div>
              </div>
              <% } %> <% if (address.addressDigital) { %>
              <div class="person-data-item">
                <div class="person-data-label">Digital Address</div>
                <div class="person-data-value">
                  <%= address.addressDigital %>
                </div>
              </div>
              <% } %>
            </div>
          </div>
          <% }); %>
        </div>
        <% } %>
      </div>
      <% } %>

      <!-- Full API Response -->
      <% if (responseData) { %>
      <div class="card" style="grid-column: 1 / -1">
        <div class="api-response-container">
          <div class="api-response-header">
            <div class="api-response-title">üì° Full API Response</div>
            <button class="btn-copy" onclick="copyToClipboard()">
              üìã Copy JSON
            </button>
          </div>
          <pre id="apiResponse">
<%= JSON.stringify(responseData, null, 2) %></pre
          >
        </div>
      </div>
      <% } %>
    </div>

    <script>
      function copyToClipboard() {
        const text = document.getElementById("apiResponse").textContent;
        navigator.clipboard.writeText(text).then(() => {
          const btn = document.querySelector(".btn-copy");
          const originalText = btn.textContent;
          btn.textContent = "‚úÖ Copied!";
          btn.style.background = "#10b981";
          setTimeout(() => {
            btn.textContent = originalText;
            btn.style.background = "";
          }, 2000);
        });
      }
    </script>
  </body>
</html>
